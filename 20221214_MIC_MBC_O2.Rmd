---
title: "20221214_MIC_MBC_oxygen"
output: html_document
date: '2022-12-14'
---

```{r setup, echo =FALSE}
.libPaths('C:\\Users\\zuendj\\Documents\\R4Libs')
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "C:/Users/zuendj/Desktop/03_data R/tryptophan_enrichment", cho = TRUE, warning = FALSE, message = FALSE)

# Install Packages:
# # install.packages("rlang")
# install.packages("tidyverse")
# # install.packages("ggbreak")
# # library(dplyr)
# library(plyr)
library(rstatix)
library(tidyverse)
# library(ggplot2)
# library(tidyr)
# # install.packages("devtools")
# # devtools::install_github("slowkow/ggrepel")
# library(ggrepel)
# library(ggbreak)
# # install.packages("openxlsx")
library(openxlsx)
```

# 1. Load the Data
```{r}
#########################################
#Load the data
########################################

setwd("P:/Shared_documents/Janina_Zuend/08_phd/09_student thesis/Marina/03_experimentation/03_MIC_MBC/01_OD-measurements/single_bacteria_for_plot")
# bacteria <- list.files(path = "P:/Shared_documents/Janina Zünd/08_phd/09_student thesis/Marina/03_experimentation/03_MIC_MBC/01_OD-measurements/single_bacteria_for_plot")

list.files(path = "C:/Users/zuendj/Desktop/03_data R/oxidative stress/input/h2o2/MIC")->bacteria
bacteria <- subset(bacteria, !bacteria %in% c("Subdoligranulum variable.csv", "Anaerobutyricum hallii.csv", "Marvinbryantia formatixigens.csv", "Ruminococcus bromii.csv"))

options(scipen=999)
#########################################
#load the data
########################################

#define empty matrices, no values added so far 
MIC_O2_values<- matrix(0, length(bacteria)*6, 12)
MIC_O2_average<- matrix(0, length(bacteria), 12)

MBC_O2_values<- matrix(0, length(bacteria)*6, 12)
MBC_O2_average<- matrix(0, length(bacteria), 12)



#MIC_O2, fill values into MIC_O2, here OD corrected values, but not corrected with agar 
row = 0
for (l in 1:length(bacteria)) {
  #generate MIC_O2wide format
  MIC_O2wide = read.csv(bacteria[l], sep=";", header=F, check.names =F)
  #look for A indicating the area in the excel file with the data

  for (r in 35:42) {
    if (MIC_O2wide[r,1]=="C") {
      zeile = r
    }
  }
#########################################
  for(i in 1:12) {
    #x indicated the colum->'A' is in column 1 and the data next to it from column 2 on
    x = 1+i
    zeile_end = zeile+6
    d = as.numeric(unlist(data.frame(MIC_O2wide[zeile:zeile_end, x])))
    for(j in 1:6){
      y = d[j]
      MIC_O2_values[row+j, i] = y
      }
  }
  
  #########################################
  #generate averages 
  for(i in 1:12) {
    r1= row+1
    r2= row+6
    MIC_O2_average[l, i] = as.numeric(mean(MIC_O2_values[r1:r2, i],  na.rm = TRUE))
  }
  
  row=row+6
  
}  

#MBC_O2, fill values into MBC_O2, here OD corrected values, but not corrected with agar 
row = 0
for (l in 1:length(bacteria)) {
  #generate MIC_O2_O2wide format
  MIC_O2wide = read.csv(bacteria[l], sep=";", header=F, check.names =F)
  #look for A indicating the area in the excel file with the data
  for (r in 49:56) {
    if (MIC_O2wide[r,1]=="C") {
      zeile = r
    }
  }
  #########################################
  for(i in 1:12) {
    #x indicated the colum->'A' is in column 1 and the data next to it from column 2 on
    x = 1+i
    zeile_end = zeile+6
    d = as.numeric(unlist(data.frame(MIC_O2wide[zeile:zeile_end, x])))
    for(j in 1:6){
      y = d[j]
        MBC_O2_values[row+j, i] = y
    }
  }
  
  #########################################
  #generate averages 
  for(i in 1:12) {
    r1= row+1
    r2= row+6
    MBC_O2_average[l, i] = as.numeric(mean(MBC_O2_values[r1:r2, i],  na.rm = TRUE))
  }
  
  row=row+6
  
}  


#########################################
```


# 4. Get the MIC for individual repleciates
```{r}
#########################################
#define row names for the blank corrected 
bacteria <- strsplit(bacteria, ".csv")
bacteria <- as.character(bacteria)


row_names<-matrix(0,length(bacteria)*6,1)
position = 0
for (i in 1:length(bacteria)) {
  for (j in 1:6) {
    row_names[position+j,1] = bacteria[i]
  }
  position = position+6
}

MIC_O2_replicates <-data.frame(row_names, MIC_O2_values)
colnames(MIC_O2_replicates)<-list("bacteria", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 , 11 , 12 )

MBC_O2_replicates <-data.frame(row_names, MBC_O2_values)
colnames(MBC_O2_replicates)<-list("bacteria", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 , 11 , 12 )
```


# 5. Export blanck corrected OD values for outlier correction
```{r}
write.xlsx(MBC_O2_replicates, file = "C:/Users/zuendj/Desktop/03_data R/oxidative stress/MBC_O2_replicates.xlsx")
write.xlsx(MIC_O2_replicates, file = "C:/Users/zuendj/Desktop/03_data R/oxidative stress/MIC_O2_replicates.xlsx")

MBC_O2_replicates<-read.xlsx("C:/Users/zuendj/Desktop/03_data R/oxidative stress/MBC_O2_replicates_mod.xlsx")
MIC_O2_replicates<-read.xlsx("C:/Users/zuendj/Desktop/03_data R/oxidative stress/MIC_O2_replicates_mod.xlsx")
```


```{r}
#get long format
average_long_O2<-gather(MIC_O2_replicates, condition, OD, "1":"13", factor_key = T )
#take averages of the technical replicate
average_long_tec_O2<-set_names(aggregate(average_long_O2$OD, list(average_long_O2$bacteria, average_long_O2$replicate, average_long_O2$condition), FUN=mean, na.rm=TRUE), colnames(average_long_O2))
#get average per condition -> to get max
average_O2<-set_names(aggregate(average_long_tec_O2$OD, list(average_long_tec_O2$bacteria, average_long_tec_O2$condition), FUN=mean, na.rm=TRUE), c("bacteria", "condition" ,"average"))
# find max
max_mic_O2<-set_names(aggregate(average_O2$average, by = list(average_O2$bacteria), max, na.rm=TRUE), c("bacteria", "max"))

MIC_replicates_wide_O2<-pivot_wider(average_long_tec_O2, names_from = condition , values_from = OD)

average_long_O2<-gather(MBC_O2_replicates, condition, OD, "1":"13", factor_key = T )
average_long_tec_O2<-set_names(aggregate(average_long_O2$OD, list(average_long_O2$bacteria, average_long_O2$replicate, average_long_O2$condition), FUN=mean, na.rm=TRUE), colnames(average_long_O2))
average_O2<-aggregate(average_long_tec_O2$OD, list(average_long_tec_O2$bacteria, average_long_tec_O2$condition), FUN=mean, na.rm=TRUE)
names(average_O2)<-c("bacteria", "condition" ,"average")
max_mbc_O2<-set_names(aggregate(average_O2$average, by = list(average_O2$bacteria), max, na.rm=TRUE), c("bacteria", "max"))

MBC_replicates_wide_O2<-pivot_wider(average_long_tec_O2, names_from = condition , values_from = OD)

MIC_mod_av_O2<-left_join(MIC_replicates_wide_O2, max_mic_O2)
MBC_mod_av_O2<-left_join(MBC_replicates_wide_O2, max_mbc_O2)




MIC_vector_O2 <- vector()
for (i in 1:nrow(MIC_mod_av_O2)) { #vertical 
  candidates <- vector()
     for(j in 3:14) {#horizontal 
       if (!is.na(MIC_mod_av_O2[i,j]) & MIC_mod_av_O2[i,j]/MIC_mod_av_O2[i, "max"]>0.1 & MIC_mod_av_O2[i,j]>0.03449526) {#-> MIC_value_absolut)

         candidates <- append(candidates, colnames(MIC_mod_av_O2)[j])
         candidates <-as.numeric(candidates)
       }
     }
  MIC_vector_O2 <- append(MIC_vector_O2, max(candidates))
}

# trial to see if results make sense to set limit at 10% of the growth of the control
# | MBC_mod_av[i,j]/MBC_mod_av[i, 14]>0.10

MBC_vector_O2 <- vector()
for (i in 1:nrow(MBC_mod_av_O2)) { #vertical 
  candidates <- vector()
  for(j in 3:14) {#horizontal 
    if (!is.na(MBC_mod_av_O2[i,j]) & MBC_mod_av_O2[i,j]/MBC_mod_av_O2[i, "max"]>0.1 & MBC_mod_av_O2[i,j]>0.03392658) {#-> MIC_value_absolut)
      
      candidates <- append(candidates, colnames(MBC_mod_av_O2)[j])
      candidates <-as.numeric(candidates)
    }
  }
  MBC_vector_O2 <- append(MBC_vector_O2, max(candidates))
}

MIC_vector_full_O2 <- vector()
for (i in 1:nrow(MIC_mod_av_O2)) { #vertical 
  candidates <- vector()
     for(j in 3:14) {#horizontal 
       if (!is.na(MIC_mod_av_O2[i,j]) & MIC_mod_av_O2[i,j]/MIC_mod_av_O2[i, "max"]>0.5 & MIC_mod_av_O2[i,j]>0.03449526) {#-> MIC_value_absolut)

         candidates <- append(candidates, colnames(MIC_mod_av_O2)[j])
         candidates <-as.numeric(candidates)
       }
     }
  MIC_vector_full_O2 <- append(MIC_vector_full_O2, max(candidates))
}

# trial to see if results make sense to set limit at 10% of the growth of the control
# | MBC_mod_av[i,j]/MBC_mod_av[i, 14]>0.10

MBC_vector_full_O2 <- vector()
for (i in 1:nrow(MBC_mod_av_O2)) { #vertical 
  candidates <- vector()
  for(j in 3:14) {#horizontal 
    if (!is.na(MBC_mod_av_O2[i,j]) & MBC_mod_av_O2[i,j]/MBC_mod_av_O2[i, "max"]>0.5 & MBC_mod_av_O2[i,j]>0.03392658 ) {#-> MIC_value_absolut)
      
      candidates <- append(candidates, colnames(MBC_mod_av_O2)[j])
      candidates <-as.numeric(candidates)
    }
  }
  MBC_vector_full_O2 <- append(MBC_vector_full_O2, max(candidates))
}
```
## Trial sig. testing

```{r}
i=1
j=4

bact<-(unique(MIC_mod_av_O2$bacteria))

df_pvalue_O2<-matrix(0, length(unique(MIC_mod_av_O2$bacteria)) , 12)
  
row=1
for (i in 1:(length(unique(MIC_mod_av_O2$bacteria)))) { #vertical 
  
  df_pvalue_O2[i,1]<-bact[i]
  
  MIC_mod_av_O2 %>%
  subset(bacteria %in% bact[i])->sub

     for(j in 4:14){#horizontal 
       
       control<-setNames(sub[c(row:(row+2)), c(3)], c("control"))
       test<-setNames(sub[c(row:(row+2)), c(j)], c("test"))
       # print(test)
       
     cbind(control, test)->mydata
     
     mydata%>%
       gather( group, OD, "control":"test") %>%
       t_test( OD ~ group, alternative = "greater") -> res

       
       
       df_pvalue_O2[i,c(j-2)]<-(res$p)
       
       
     }
  df_pvalue_O2[i, 1]<-bact[i]
  }





df_pvalue_MBC_O2<-matrix(0, length(unique(MBC_mod_av_O2$bacteria)) , 12)
  
row=1
for (i in 1:(length(unique(MBC_mod_av_O2$bacteria)))) { #vertical 
  
  df_pvalue_MBC_O2[i,1]<-bact[i]
  
  MBC_mod_av_O2 %>%
  subset(bacteria %in% bact[i])->sub

     for(j in 4:14){#horizontal 
       
       control<-setNames(sub[c(row:(row+2)), c(3)], c("control"))
       test<-setNames(sub[c(row:(row+2)), c(j)], c("test"))
       # print(test)
       
     cbind(control, test)->mydata
     
     mydata%>%
       gather( group, OD, "control":"test") %>%
       t_test( OD ~ group, alternative = "greater") -> res

       
       
       df_pvalue_MBC_O2[i,c(j-2)]<-(res$p)
       
       
     }
  df_pvalue_MBC_O2[i, 1]<-bact[i]
  }


df_pvalue_O2<-setNames(as.data.frame(df_pvalue_O2), c("bacteria", 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12))
df_pvalue_MBC_O2<-setNames(as.data.frame(df_pvalue_MBC_O2), c("bacteria", 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12))

df_pvalue_MBC_O2$assay<-"MBC"
df_pvalue_O2$assay<-"MIC"

df_pvalue_both_O2<-rbind(df_pvalue_O2, df_pvalue_MBC_O2)

```



```{r}
df_pvalue_both_O2%>%
  gather(condition, p_value, ("2":"12"))->p_long_O2

p_long_O2$p_value<-as.numeric(p_long_O2$p_value)


for (i in 1:nrow(p_long_O2)){
if(p_long_O2[i,c("p_value")]<0.01){
  p_long_O2[i,c("significance")]<-"*"
}}

```


```{r}
#assign vectors with MIC/MBCs to df
df_final_replicates_O2 <- data.frame(bacteria = MIC_mod_av_O2$bacteria, 
                                  replicate = MIC_mod_av_O2$replicate,
                                  MIC = as.numeric(MIC_vector_O2), 
                                  MBC = as.numeric(MBC_vector_O2),
                                  MIC_75 =as.numeric(MIC_vector_full_O2),
                                  MBC_75 =as.numeric(MBC_vector_full_O2))


order_O2<-aggregate(df_final_replicates_O2$MBC_75, by=list(df_final_replicates_O2$bacteria), mean)
colnames(order_O2) <-c("bacteria", "order")

df_final_replicates_O2<-left_join(df_final_replicates_O2, order_O2)

df_long_O2<-gather(df_final_replicates_O2[,c("bacteria", "replicate", "MIC", "MBC", "order")], assay, value, "MIC":"MBC", factor_key = T)

df_long_75_O2<-gather(df_final_replicates_O2[,c("bacteria", "replicate", "MIC_75", "MBC_75", "order")], assay, value_75, "MIC_75":"MBC_75", factor_key = T)
names(df_long_75_O2)[names(df_long_75_O2) == "MIC_75"] <- "MIC"

df_long_75_O2$assay <- recode_factor(df_long_75_O2$assay, MIC_75 = "MIC", 
                                MBC_75 = "MBC")

df_long_both_O2<-left_join(df_long_O2, df_long_75_O2)




```
```{r}
quantile(df_final_replicates_O2$MIC)

quantile(df_final_replicates_O2$MBC)

ggplot(df_final_replicates_O2, aes(x=MIC))+
  geom_boxplot()
  # geom_point(aes(colour=bacteria))

```


## Go back to the heatplot with relative od values
```{r}
MBC_rel_O2<-MBC_mod_av_O2
MIC_rel_O2<-MIC_mod_av_O2

for (i in 1:nrow(MIC_rel_O2)) { #vertical 
  for(j in 3:14) {#horizontal 
     MIC_rel_O2[i,j] = MIC_rel_O2[i,j]/MIC_rel_O2[i, c("max")] 
  }}

for (i in 1:nrow(MBC_rel_O2)) { #vertical 
  for(j in 3:14) {#horizontal 
     MBC_rel_O2[i,j] = MBC_rel_O2[i,j]/MBC_rel_O2[i, c("max")] 
  }}


# MBC_relgrowth_value<-cbind(MBC_rel, df_final_replicates)
# MIC_relgrowth_value<-cbind(MIC_rel, df_final_replicates)


MIC_rel_long_O2<-gather(MIC_rel_O2, condition, OD, "1":"13", factor_key = T)
MIC_rel_long_O2$assay<-c("MIC")
MBC_rel_long_O2<-gather(MBC_rel_O2, condition, OD, "1":"13", factor_key = T)
MBC_rel_long_O2$assay<-c("MBC")

MBC_MIC_rel_long_O2<-rbind(MIC_rel_long_O2, MBC_rel_long_O2)
MBC_MIC_rel_long_O2<-left_join(MBC_MIC_rel_long_O2, df_long_both_O2)

```


```{r}
MBC_MIC_rel_long_O2$OD[MBC_MIC_rel_long_O2$OD <0.1]<-0
MBC_MIC_rel_long_O2$condition<-as.numeric(paste(MBC_MIC_rel_long_O2$condition))


for (i in 1:nrow(MBC_MIC_rel_long_O2)){
  if ( MBC_MIC_rel_long_O2[i, c("condition")] == MBC_MIC_rel_long_O2[i, c("value")]) { 
    MBC_MIC_rel_long_O2[i, c("label")] = MBC_MIC_rel_long_O2[i, c("value")]}}

MBC_MIC_rel_long_O2$label<-as.numeric(MBC_MIC_rel_long_O2$label)

for (i in 1:nrow(MBC_MIC_rel_long_O2)){
  if ( MBC_MIC_rel_long_O2[i, c("condition")] == MBC_MIC_rel_long_O2[i, c("value_75")]) { 
    MBC_MIC_rel_long_O2[i, c("label_75")] = MBC_MIC_rel_long_O2[i, c("value_75")]}}

MBC_MIC_rel_long_O2$label_75<-as.numeric(MBC_MIC_rel_long_O2$label_75)


MBC_MIC_rel_long_label_O2<-gather(MBC_MIC_rel_long_O2, label_type, label_value, "label":"label_75")
```


```{r}

MBC_MIC_rel_long_label_O2$label_value<-MBC_MIC_rel_long_label_O2$label_value+1

MBC_MIC_rel_long_label_O2$OD[MBC_MIC_rel_long_label_O2$condition == 13]<-NA


MBC_MIC_rel_long_label_O2%>%
  subset(!bacteria %in% c("Subdoligranulum variable", "Anaerobutyricum hallii", "Marvinbryantia formatixigens", "Ruminococcus bromii"))%>%
  drop_na(OD)->hoi
p_long_O2$condition<-as.numeric(p_long_O2$condition)
hoihoi<-left_join(hoi, p_long_O2)




hoihoi%>%
  subset(label_type %in% "label")->hoihoi

hoihoi$assay<-factor(hoihoi$assay, levels=c("MIC", "MBC"))

hoihoi%>%
  mutate(bacteria = fct_reorder(bacteria, hoihoi$order))%>%
  ggplot(aes(x = condition, y = assay, fill = OD)) + 
  geom_raster() +
  # scale_shape_manual(values = c(16, 1), labels=c("10%", "50%"))+
scale_color_manual(values=c("coral2", "darkseagreen"), labels=c("stress", "post-stress"))+
  labs(x=expression(paste("Oxygenation")))+
  theme(text = element_text(size=15), 
        axis.title.x = element_text(size=20),
        axis.text.x = element_text(size=15, angle = 90, vjust= 0.5, hjust=1),
        axis.title.y= element_blank(),
        axis.text.y=element_blank(),
        strip.text.y = element_text(angle = 0, face = "italic", hjust=0),
        strip.background = element_blank(),
        axis.ticks.y = element_blank(),
        legend.text = element_text(size = 15),
        legend.title = element_text(size= 20),
        plot.title = element_text(size=20),
        strip.text = element_text(size=15))+
  facet_grid(rows =vars(bacteria), scales = "free", space = "free")+
  geom_point(aes(x=label_value, color=assay),  size=2.5, alpha=0.75, position=position_jitterdodge(jitter.width = 0.3, jitter.height = 0.1))+
  # geom_text(aes(label=label, color=assay))+
  scale_x_continuous(labels=c("0",
                              "2.2", 
                              "4.8",  
                              "10.6", 
                              "23.4", 
                              "51.5", 
                              "113",  
                              "249",
                              "549",
                              "1207",
                              "2656",  
                              "5843"), 
                     breaks=c(1, 2, 3, 4, 5, 6, 7,  8 ,9 ,10, 11, 12))+
  labs(fill = expression(relative~OD[600]), colour="")+
  ggtitle(expression(Growth~capability~under~different~oxygenation~conditions))+
  geom_text(aes(label=significance), colour="white")+
  scale_y_discrete(limits=rev)->p

show(p)



ggsave(filename = "MIC_MBC_o2_groeth.jpeg", 
       path = "C:/Users/zuendj/Desktop/03_data R/oxidative stress/output_reanalysis", 
       width = 22,
       height = 30,
       units = c("cm"))



```

```{r}
hoihoi%>%
  subset(label_type %in% "label")->hoihoi
hoihoi$assay<-factor(hoihoi$assay, levels=c("MIC", "MBC"))
hoihoi <- hoihoi %>%
    mutate(bacteria = recode(bacteria, "Eubacterium eligens" = "Lachnospira eligens"))

hoihoi%>%
  mutate(bacteria = fct_reorder(bacteria, hoihoi$order))%>%
  ggplot(aes(x = condition, y = assay, fill = OD)) + 
  geom_raster() +
  scale_fill_steps(breaks = c(0,0.25,0.5, 0.75, 1))+
  labs(x=expression(paste("Oxygenation")))+
  theme(text = element_text(size=15), 
        axis.title.x = element_text(size=20),
        axis.text.x = element_text(size=15, angle = 90, vjust= 0.5, hjust=1),
        axis.title.y= element_blank(),
        axis.text.y=element_text(size=15),
        strip.text.y = element_text(angle = 0, face = "italic", hjust=0),
        strip.background = element_blank(),
        axis.ticks.y = element_blank(),
        legend.position = "bottom",
        legend.text = element_text(size = 15, vjust=0.8, angle=90, hjust=0.8),
        legend.title = element_text(size= 15, vjust=1),
        plot.title = element_text(size=20, hjust=0.25),
        strip.text = element_text(size=15), 
        panel.background = element_rect(fill="white"),
        panel.border=element_rect(fill=NA))+
  facet_grid(rows =vars(bacteria), scales = "free", space = "free")+
  scale_x_continuous(labels=c("0",
                              "2.2", 
                              "4.8",  
                              "10.6", 
                              "23.4", 
                              "51.5", 
                              "113",  
                              "249",
                              "549",
                              "1207",
                              "2656",  
                              "5843"), 
                     breaks=c(1, 2, 3, 4, 5, 6, 7,  8 ,9 ,10, 11, 12))+
  scale_y_discrete(labels = c('MIC' = 'stress', 'MBC' = 'post-stress'), limits=rev)+
  labs(fill = expression(relative~OD[600]), colour="")+
  ggtitle(expression(Growth~capability~with~different~oxygenation))->p

show(p)




ggsave(filename = "MIC_MBC_o2_growth_only.jpeg", 
       path = "C:/Users/zuendj/Desktop/03_data R/oxidative stress/output_reanalysis", 
       width = 17,
       height = 35,
       units = c("cm"))

```

# 6. Export MIC/MBC values
```{r}
o2<-set_names(aggregate(hoi$value, by=list(hoi$bacteria, hoi$assay), FUN=mean), c("bacteria", "assay", "value_O2"))
write.xlsx(o2, file = "C:/Users/zuendj/Desktop/03_data R/oxidative stress/MIC_MBC_O2.xlsx")
```

# Medium only
```{r}
setwd("P:/Shared_documents/Janina ZÃ¼nd/08_phd/09_student thesis/Marina/03_experimentation/03_MIC_MBC/01_OD-measurements/single_bacteria_for_plot")
bacteria <- list.files(path = "P:/Shared_documents/Janina ZÃ¼nd/08_phd/09_student thesis/Marina/03_experimentation/03_MIC_MBC/01_OD-measurements/single_bacteria_for_plot")

options(scipen=999)
#########################################
#load the data
########################################

#define empty matrices, no values added so far 

MBC_vector_blank<- vector()



#MBC, fill values into MBC, here OD corrected values, but not corrected with agar 
row = 0
for (l in 1:length(bacteria)) {
  #generate MICwide format
  MICwide = read.csv(bacteria[l], sep=";", header=F, check.names =F)
  #look for A indicating the area in the excel file with the data
  for (r in 19:25) {
    if (MICwide[r,1]=="B") {
      zeile = r
      x<-as.numeric(unlist(MICwide[r,c(2:13)]))

      MBC_vector_blank <- append(MBC_vector_blank, x)
    }
  }}
  #########################################


print(sd(MBC_vector_blank)*3)
summary(MBC_vector_blank)
#########################################
```
```{r}
setwd("P:/Shared_documents/Janina ZÃ¼nd/08_phd/09_student thesis/Marina/03_experimentation/03_MIC_MBC/01_OD-measurements/single_bacteria_for_plot")
bacteria <- list.files(path = "P:/Shared_documents/Janina ZÃ¼nd/08_phd/09_student thesis/Marina/03_experimentation/03_MIC_MBC/01_OD-measurements/single_bacteria_for_plot")

options(scipen=999)
#########################################
#load the data
########################################

#define empty matrices, no values added so far 

MIC_blank_values<- vector()




#MBC, fill values into MBC, here OD corrected values, but not corrected with agar 
row = 0
for (l in 1:length(bacteria)) {
  #generate MICwide format
  MICwide = read.csv(bacteria[l], sep=";", header=F, check.names =F)
  #look for A indicating the area in the excel file with the data
  for (r in 4:12) {
   if (MICwide[r,1]=="B") {
      zeile = r
      x<-as.numeric(unlist(MICwide[r,c(2:13)]))
      MIC_vector_blank <- append(MBC_vector_blank, x)}}}

print(sd(MIC_vector_blank)*3)

summary(MIC_vector_blank)
#########################################
```

